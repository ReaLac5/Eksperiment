<!-- update_companies.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Update Companies</title>
</head>
<body>
    <h1>Update Companies</h1>
    <form method="post">
        {% csrf_token %}
        <label for="person_id">Select Person ID:</label>
        <select id="person_id" name="person_id">
            {% for person in people_list %}
                <option value="{{ person.id }}">{{ person.id }}</option>
            {% endfor %}
        </select>
        <br>
        <label for="companies">Companies (comma-separated):</label>
        <input type="text" id="companies" name="companies">
        <br>
        <ul id="person_companies"></ul> <!-- New element to display companies -->
        <br>
        <button type="submit">Update Companies</button>

        <script>
            const selectPerson = document.getElementById('person_id');
            const companiesInput = document.getElementById('companies');
            const personCompaniesList = document.getElementById('person_companies');
            const peopleList = {{ people_list|safe }};
            
            selectPerson.addEventListener('change', function() {
                const selectedPersonId = this.value;
                const selectedPerson = peopleList.find(person => person.id === selectedPersonId);
                
                if (selectedPerson) {
                    companiesInput.value = selectedPerson.companies.join(', ');
                    
                    // Display companies in a list
                    personCompaniesList.innerHTML = '';
                    selectedPerson.companies.forEach(company => {
                        const li = document.createElement('li');
                        li.textContent = company;
                        personCompaniesList.appendChild(li);
                    });
                }
            });
        </script>
    </form>
</body>
</html>
